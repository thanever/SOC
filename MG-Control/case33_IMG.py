from numpy import array

def case33_IMG():
    ppc = {"version": '2'}
    ppc["baseMVA"] = 100.0


    pi = 3.141592653589793
    ppc["baseOmega"] = 2 * pi * 50
    ppc["refbus"] = 15  # set as the first bus. reference bus for voltage angle; angle of refbus is set as 0.

    ## bus data
    # bus_i type Pd(p_set_point) Qd(q_set_point) Gs Bs area Vm Va baseKV zone Vmax Vmin
    ppc["bus"] = array([ 
        [	2,	1,	0.1  , 0.06 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	3,	1,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	4,	1,	0.12 , 0.08 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	5,	1,	0.06 , 0.03 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	6,	1,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	7,	1,	0.2  , 0.1  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	8,	1,	0.2  , 0.1  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	9,	1,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	10,	1,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	11,	1,	0.045, 0.03 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	12,	1,	0.06 , 0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	13,	1,	0.06 , 0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	14,	1,	0.12 , 0.08 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	15,	3,	0.06 , 0.01 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	16,	1,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	17,	1,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	18,	1,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	19,	1,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	20,	1,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	21,	2,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	22,	1,	0.09 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	23,	1,	0.09 , 0.05 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	24,	1,	0.42 , 0.2  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	25,	1,	0.42 , 0.2  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	26,	1,	0.06 , 0.025,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	27,	1,	0.06 , 0.025,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	28,	2,	0.06 , 0.02 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	29,	1,	0.12 , 0.07 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	30,	1,	0.2  , 0.6  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	31,	1,	0.15 , 0.07 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	32,	1,	0.21 , 0.1  ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [	33,	1,	0.06 , 0.04 ,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9]
    ])
 
    ## generator data
    # bus, Pg, Qg, Qmax, Qmin, Vg, mBase, status, Pmax, Pmin, Pc1, Pc2,
    # Qc1min, Qc1max, Qc2min, Qc2max, ramp_agc, ramp_10, ramp_30, ramp_q, apf, 
    # ADDITIONAL PARAMETERS: tau_p, k_p, tau_q, k_q
    ppc["gen"] = array([
        [15, 0,   0,  4, -4,  1.000,  100, 1, 4, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,   0.5, 0.8, 0.5,  0.1],
        [21, 2.0,   0,  4, -4,  1.005,  100, 1, 4, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0.4, 0.5,  0.1],
        [28, 1.0,   0,  4, -4,  1.005,  100, 1, 4, -4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0.1, 0.5,  0.1]
    ])

    ## branch data
    # fbus, tbus, r(p.u.), x, b, rateA, rateB, rateC, ratio, angle, status, angmin, angmax
    ppc["branch"] = array([
        [	18,	22,	0.02000000,  0.0200000,	0,	10,	0,	0,	0,	0,	0,	-30,	30], 
        [	2,	3,	0.30759517, 0.15666764,	0,	13,	0,	0,	0,	0,	1,	-30,	30],
        [	3,	4,	0.22835666, 0.11629967,	0,	6,	0,	0,	0,	0,	1,	-30,	30],
        [	4,	5,	0.23777793, 0.1211039 ,	0,	6,	0,	0,	0,	0,	1,	-30,	30],
        [	5,	6,	0.51099481, 0.44111518,	0,	5,	0,	0,	0,	0,	1,	-30,	30],
        [	6,	7,	0.11679881, 0.38608497,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	7,	8,	0.44386045, 0.14668484,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	8,	9,	0.64264305, 0.46170471,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	9,	10,	0.651378  , 0.46170471,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	10,	11,	0.12266371, 0.04055514,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	11,	12,	0.23359763, 0.07724195,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	12,	13,	0.91592232, 0.72063371,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	13,	14,	0.33791794, 0.44479634,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	14,	15,	0.36873985, 0.3281847 ,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	15,	16,	0.46563544, 0.34003928,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	16,	17,	0.8042397 , 1.07377542,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	17,	18,	0.45671331, 0.35813312,	0,	1,	0,	0,	0,	0,	1,	-30,	30],
        [	2,	19,	0.10232375, 0.09764431,	0,	6,	0,	0,	0,	0,	1,	-30,	30],
        [	19,	20,	0.93850842, 0.84566834,	0,	5,	0,	0,	0,	0,	1,	-30,	30],
        [	20,	21,	0.25549741, 0.29848586,	0,	5,	0,	0,	0,	0,	1,	-30,	30],
        [	21,	22,	0.44230064, 0.58480517,	0,	3,	0,	0,	0,	0,	1,	-30,	30],
        [	3,	23,	0.28151509, 0.19235617,	0,	7,	0,	0,	0,	0,	1,	-30,	30],
        [	23,	24,	0.56028491, 0.44242542,	0,	6,	0,	0,	0,	0,	1,	-30,	30],
        [	24,	25,	0.55903706, 0.43743402,	0,	5,	0,	0,	0,	0,	1,	-30,	30],
        [	6,	26,	0.12665683, 0.06451387,	0,	3,	0,	0,	0,	0,	1,	-30,	30],
        [	26,	27,	0.17731957, 0.09028199,	0,	3,	0,	0,	0,	0,	1,	-30,	30],
        [	27,	28,	0.66073688, 0.58255904,	0,	3,	0,	0,	0,	0,	1,	-30,	30],
        [	28,	29,	0.50176072, 0.43712206,	0,	3,	0,	0,	0,	0,	1,	-30,	30],
        [	29,	30,	0.31664208, 0.16128469,	0,	4,	0,	0,	0,	0,	1,	-30,	30],
        [	30,	31,	0.6079528 , 0.60084005,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	31,	32,	0.1937288 , 0.22579856,	0,	2,	0,	0,	0,	0,	1,	-30,	30],
        [	32,	33,	0.21275852, 0.33080519,	0,	1,	0,	0,	0,	0,	1,	-30,	30]
    ])

    ## subsystem data
    # subsystem_i, status of branch 1, status of branch 2, ...
    ppc["subsystem"] = array([
        [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
    ])

    ## bound parameters for \mathcal{X}
    # theta_min, theta_max, omega, v
    ppc["x_bound"] = array([
        [15,     0,    0, 0.8, 1.2, 0.2, 1.8],
        [21,     -pi, pi, 0.8, 1.2, 0.2, 1.8],
        [28,     -pi, pi, 0.8, 1.2, 0.2, 1.8] 
    ]) 

    return ppc

